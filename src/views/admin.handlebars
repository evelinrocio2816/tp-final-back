<h1>Admin Panel</h1>

<h2>User List</h2>
<ul class="cartUser">
    {{#each usersJSON}}
    <li>
        Name: {{this.first_name}} {{this.last_name}} | <br>
        Email: {{this.email}} | <br>
        Role: {{this.role}}
        
        <!-- Formulario de Edición -->
        <form action="/api/user/admin/users/{{this._id}}/edit" method="POST">
            <button type="submit">Edit</button>
        </form>
        
        <!-- Formulario de Eliminación -->
        <form class="delete-user-form" data-id="{{this._id}}" onsubmit="return confirm('Are you sure you want to delete this user?');">
            <button type="submit">Delete</button>
        </form>
    </li>
    {{/each}}
</ul>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.delete-user-form').forEach(form => {
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            const userId = form.getAttribute('data-id');
            const response = await fetch(`/api/user/admin/users/${userId}`, {
                method: 'DELETE'
            });
            if (response.ok) {
                window.location.href = '/admin/users';
            } else {
                alert('Error al eliminar el usuario');
            }
        });
    });
});
</script>
